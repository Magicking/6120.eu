<!doctype html><html lang=en>
<head>
<title>Support cours Ethereum Virtual Machine :: 6120's Blog</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Ceci est un support de cours sur l&amp;rsquo;EVM (Ethereum Virtual Machine) pour le cours de l&amp;rsquo;Ecole Sup√©rieure d&amp;rsquo;Ing√©nieurs L√©onard de Vinci (ESILV).
Il comprend du mat√©riel de cours, des illustrations et des liens vers des ressources.
La dur√©e du cours est de 3h, s√©par√© en une lesson de 1h15 et des travaux dirig√©s de 1h15. La premi√®re partie est une introduction √† la machine de Turing et sa correspondance aux processeurs de nos jours (rappel des connaissances), la seconde partie est une introduction √† l&amp;rsquo;EVM et sa correspondance avec la machine de Turing.">
<meta name=keywords content="teaching,french,esilv,evm,ethereum">
<meta name=robots content="noodp">
<link rel=canonical href=/posts/support-evm/>
<link rel=stylesheet href=/styles.css>
<link rel="shortcut icon" href=/img/theme-colors/black.png>
<link rel=apple-touch-icon href=/img/theme-colors/black.png>
<meta name=twitter:card content="summary">
<meta name=twitter:site content="https://6120.eu">
<meta name=twitter:creator content>
<meta property="og:locale" content="en">
<meta property="og:type" content="article">
<meta property="og:title" content="Support cours Ethereum Virtual Machine">
<meta property="og:description" content="Ceci est un support de cours sur l&amp;rsquo;EVM (Ethereum Virtual Machine) pour le cours de l&amp;rsquo;Ecole Sup√©rieure d&amp;rsquo;Ing√©nieurs L√©onard de Vinci (ESILV).
Il comprend du mat√©riel de cours, des illustrations et des liens vers des ressources.
La dur√©e du cours est de 3h, s√©par√© en une lesson de 1h15 et des travaux dirig√©s de 1h15. La premi√®re partie est une introduction √† la machine de Turing et sa correspondance aux processeurs de nos jours (rappel des connaissances), la seconde partie est une introduction √† l&amp;rsquo;EVM et sa correspondance avec la machine de Turing.">
<meta property="og:url" content="/posts/support-evm/">
<meta property="og:site_name" content="6120's Blog">
<meta property="og:image" content="/">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">
<meta property="article:published_time" content="2022-03-17 21:50:00 +0100 +0100">
</head>
<body>
<div class=black>
<div class=fuzz></div>
<div class="container center headings--one-size">
<header class=header>
<div class=header__inner>
<div class=header__logo>
<a href=/>
<div class=logo>
Magicking's notes
</div>
</a>
</div>
</div>
</header>
<div class=content>
<article class=post>
<h1 class=post-title>
<a href=/posts/support-evm/>Support cours Ethereum Virtual Machine</a>
</h1>
<div class=post-meta>
<time class=post-date>
2022-03-17 ::
[Updated :: 2022-03-17]
</time>
<span class=post-reading-time>:: 3 min read (458 words)</span>
</div>
<span class=post-tags>
#<a href=/tags/teaching/>teaching</a>&nbsp;
#<a href=/tags/french/>french</a>&nbsp;
#<a href=/tags/esilv/>esilv</a>&nbsp;
#<a href=/tags/evm/>evm</a>&nbsp;
#<a href=/tags/ethereum/>ethereum</a>&nbsp;
</span>
<div class=post-content><div>
<p>Ceci est un support de cours sur l&rsquo;EVM (Ethereum Virtual Machine) pour le cours de l&rsquo;Ecole Sup√©rieure d&rsquo;Ing√©nieurs L√©onard de Vinci (ESILV).</p>
<p>Il comprend du mat√©riel de cours, des illustrations et des liens vers des ressources.</p>
<p>La dur√©e du cours est de 3h, s√©par√© en une lesson de 1h15 et des travaux dirig√©s de 1h15.
La premi√®re partie est une introduction √† la machine de Turing et sa correspondance aux processeurs de nos jours (rappel des connaissances),
la seconde partie est une introduction √† l&rsquo;EVM et sa correspondance avec la machine de Turing.</p>
<p>Les travaux pratiques consistent √† observer le fonctionnement de l&rsquo;EVM ainsi que la lecture des <a href=https://www.evm.codes/>opcodes</a> au travers du debugger <a href=https://remix.ethereum.org/>Remix</a> et √† impl√©menter des opcodes directement dans un second temps.</p>
<p>NB: Tenderly peut-√™tre utilis√© pour une meilleure observervation du fonctionnement de l&rsquo;EVM sur la blockchain Ethereum mais un peu plus long √† mettre en place.</p>
<h1 id=machine-de-turing>Machine de Turing<a href=#machine-de-turing class=hanchor arialabel=Anchor>&#8983;</a> </h1>
<p>Machine de Turing
<img src=/img/posts/support-evm/mThs6b2.jpg alt>
<a href="https://www.youtube.com/watch?v=L5O04P2ASRc&t=647s">https://www.youtube.com/watch?v=L5O04P2ASRc&t=647s</a></p>
<h1 id=ethereum-virtual-machine-evm>Ethereum Virtual Machine (EVM)<a href=#ethereum-virtual-machine-evm class=hanchor arialabel=Anchor>&#8983;</a> </h1>
<p><img src=/img/posts/support-evm/ysIsVUG.png alt></p>
<hr>
<p><img src=/img/posts/support-evm/Xba9Jwb.png alt></p>
<hr>
<p>Lexiques
<a href=https://github.com/asseth/yellowpaper/blob/7dd3ed26b6fe4b7a1b0394194ef268d01f9955b4/Paper.pdf>https://github.com/asseth/yellowpaper/blob/7dd3ed26b6fe4b7a1b0394194ef268d01f9955b4/Paper.pdf</a> Page 17</p>
<hr>
<p><img src=/img/posts/support-evm/Lo0fP89.png alt></p>
<hr>
<p><img src=/img/posts/support-evm/8cOg89m.png alt></p>
<hr>
<p><img src=/img/posts/support-evm/vRJgorg.png alt></p>
<hr>
<p><img src=/img/posts/support-evm/tMgjFeK.png alt></p>
<hr>
<p><img src=/img/posts/support-evm/cnV0k5f.png alt></p>
<hr>
<p><img src=/img/posts/support-evm/0J3imfd.png alt></p>
<hr>
<p>Dive in <a href=http://takenobu-hs.github.io/downloads/ethereum_evm_illustrated.pdf>http://takenobu-hs.github.io/downloads/ethereum_evm_illustrated.pdf</a></p>
<h2 id=illustration>Illustration<a href=#illustration class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<ul>
<li>Illustration Turing machine => <a href=https://medium.com/creative-automata/classic-turing-machine-with-tape-erasure-e14870ad154e>https://medium.com/creative-automata/classic-turing-machine-with-tape-erasure-e14870ad154e</a></li>
<li><a href=http://takenobu-hs.github.io/downloads/ethereum_evm_illustrated.pdf>http://takenobu-hs.github.io/downloads/ethereum_evm_illustrated.pdf</a></li>
</ul>
<h2 id=bibliography>Bibliography<a href=#bibliography class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<ul>
<li>
<p>üá´üá∑ <a href=https://github.com/asseth/yellowpaper/blob/7dd3ed26b6fe4b7a1b0394194ef268d01f9955b4/Paper.pdf>EIP-150 Yellowpaper</a></p>
</li>
<li>
<p>üá¨üáß <a href=https://ethereum.github.io/yellowpaper/paper.pdf>Updated Yellowpaper</a></p>
</li>
<li>
<p><a href=https://github.com/benjaminion/YellowPaper_CheatSheet>Yellowpaper Cheat Sheet</a></p>
</li>
<li>
<p><a href=http://takenobu-hs.github.io/downloads/ethereum_evm_illustrated.pdf>Ethereum EVM Illustrated</a></p>
</li>
<li>
<p>Execution model Page 56</p>
</li>
</ul>
<h2 id=implementation>Implementation<a href=#implementation class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<ul>
<li><a href=https://github.com/ethereum/go-ethereum/blob/master/core/vm/interpreter.go#L138>Implementation allocation</a></li>
</ul>
<h1 id=travaux-dirig√©s>Travaux dirig√©s<a href=#travaux-dirig√©s class=hanchor arialabel=Anchor>&#8983;</a> </h1>
<ul>
<li><a href=https://remix.ethereum.org/>Remix</a></li>
<li><a href=https://www.evm.codes/>EVM opcodes</a></li>
</ul>
<p>Solidity sources to analyze:</p>
<ul>
<li>Goal, observe the behavior of the EVM between the differents implementation functions of the same algorithm:
<ul>
<li>Sum of an array of uint.</li>
</ul>
</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-solidity data-lang=solidity><span style=color:#75715e>// SPDX-License-Identifier: GPL-3.0
</span><span style=color:#75715e></span><span style=color:#66d9ef>pragma solidity</span> <span style=color:#f92672>&gt;=</span><span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>4</span>.<span style=color:#ae81ff>16</span> <span style=color:#f92672>&lt;</span><span style=color:#ae81ff>0</span>.<span style=color:#ae81ff>9</span>.<span style=color:#ae81ff>0</span>;

<span style=color:#66d9ef>library</span> VectorSum {
<span style=color:#75715e>// This function is less efficient because the optimizer currently fails to
</span><span style=color:#75715e>// remove the bounds checks in array access.
</span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>sumSolidity</span>(<span style=color:#66d9ef>uint</span>[] <span style=color:#66d9ef>memory</span> data) <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>pure</span> <span style=color:#66d9ef>returns</span> (<span style=color:#66d9ef>uint</span> sum) {
   <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>uint</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> data.length; <span style=color:#f92672>++</span>i)
       sum <span style=color:#f92672>+=</span> data[i];
}

<span style=color:#75715e>// We know that we only access the array in bounds, so we can avoid the check.
</span><span style=color:#75715e>// 0x20 needs to be added to an array because the first slot contains the
</span><span style=color:#75715e>// array length.
</span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>sumAsm</span>(<span style=color:#66d9ef>uint</span>[] <span style=color:#66d9ef>memory</span> data) <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>pure</span> <span style=color:#66d9ef>returns</span> (<span style=color:#66d9ef>uint</span> sum) {
   <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>uint</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> data.length; <span style=color:#f92672>++</span>i) {
       <span style=color:#66d9ef>assembly</span> {
           sum <span style=color:#f92672>:=</span> <span style=color:#a6e22e>add</span>(sum, <span style=color:#a6e22e>mload</span>(<span style=color:#a6e22e>add</span>(<span style=color:#a6e22e>add</span>(data, <span style=color:#ae81ff>0x20</span>), <span style=color:#a6e22e>mul</span>(i, <span style=color:#ae81ff>0x20</span>))))
       }
   }
}

<span style=color:#75715e>// Same as above, but accomplish the entire code within inline assembly.
</span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>sumPureAsm</span>(<span style=color:#66d9ef>uint</span>[] <span style=color:#66d9ef>memory</span> data) <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>pure</span> <span style=color:#66d9ef>returns</span> (<span style=color:#66d9ef>uint</span> sum) {
   <span style=color:#66d9ef>assembly</span> {
       <span style=color:#75715e>// Load the length (first 32 bytes)
</span><span style=color:#75715e></span>       <span style=color:#f92672>let</span> len <span style=color:#f92672>:=</span> <span style=color:#a6e22e>mload</span>(data)

       <span style=color:#75715e>// Skip over the length field.
</span><span style=color:#75715e></span>       <span style=color:#75715e>//
</span><span style=color:#75715e></span>       <span style=color:#75715e>// Keep temporary variable so it can be incremented in place.
</span><span style=color:#75715e></span>       <span style=color:#75715e>//
</span><span style=color:#75715e></span>       <span style=color:#75715e>// NOTE: incrementing data would result in an unusable
</span><span style=color:#75715e></span>       <span style=color:#75715e>//       data variable after this assembly block
</span><span style=color:#75715e></span>       <span style=color:#f92672>let</span> dataElementLocation <span style=color:#f92672>:=</span> <span style=color:#a6e22e>add</span>(data, <span style=color:#ae81ff>0x20</span>)

       <span style=color:#75715e>// Iterate until the bound is not met.
</span><span style=color:#75715e></span>       <span style=color:#a6e22e>for</span>
           { <span style=color:#f92672>let</span> end <span style=color:#f92672>:=</span> <span style=color:#a6e22e>add</span>(dataElementLocation, <span style=color:#a6e22e>mul</span>(len, <span style=color:#ae81ff>0x20</span>)) }
           <span style=color:#a6e22e>lt</span>(dataElementLocation, end)
           { data <span style=color:#f92672>:=</span> <span style=color:#a6e22e>add</span>(dataElementLocation, <span style=color:#ae81ff>0x20</span>) }
       {
           sum <span style=color:#f92672>:=</span> <span style=color:#a6e22e>add</span>(sum, <span style=color:#a6e22e>mload</span>(dataElementLocation))
       }
   }
}
}
</code></pre></div><h1 id=contact>Contact<a href=#contact class=hanchor arialabel=Anchor>&#8983;</a> </h1>
<ul>
<li><a href=https://twitter.com/magicking_>@magicking_</a></li>
<li><a href=mailto:s@6120.eu>s@6120.eu</a></li>
<li><a href=https://6120.eu>https://6120.eu</a></li>
</ul>
</div></div>
<div class=pagination>
<div class=pagination__title>
<span class=pagination__title-h>Read other posts</span>
<hr>
</div>
<div class=pagination__buttons>
<span class="button previous">
<a href=/posts/cairo-changelog-pov/>
<span class=button__icon>‚Üê</span>
<span class=button__text>StarkNet & Cairo significant changes developer opinionated view</span>
</a>
</span>
<span class="button next">
<a href=/posts/altfury/>
<span class=button__text>Altfury a remote wallet provider (GSaaS*) design document - Work In Progress</span>
<span class=button__icon>‚Üí</span>
</a>
</span>
</div>
</div>
<div id=disqus_thread></div>
<script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//6120s-blog.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script>
<noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript>
<a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a>
</article>
</div>
<footer class=footer>
<div class=footer__inner>
<div class="copyright copyright--user">
<span> </span>
</div>
</div>
</footer>
<script type=text/javascript src=/bundle.min.js></script>
</div>
</div>
</body>
<script>(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-90022466-1','auto'),ga('send','pageview')</script>
</html>